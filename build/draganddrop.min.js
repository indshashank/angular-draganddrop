/*! draganddrop 2014-06-29 */
"use strict";!function(a){var b="$destroy",c="mousedown",d="mouseup",e="mouseenter",f="mouseleave",g="mousemove",h="touchstart",i="touchend",j="touchmove",k="mouse",l="touchend";a.controller("DragAndDropItemController",["$scope","$element","$document",function(a,b){a.init=function(c){a.value=c,a.value.$element=b}}]),a.controller("DragAndDropController",["$rootScope","$scope","dragAndDrop","$document",function(a,c,e,f){var h=function(){e.hasData(k)&&c.$apply(function(){e.removeData(k)})},m=function(a){e.hasData(k)&&e.getData(k).$element.css({top:a.pageY+5,left:a.pageX+5,visibility:"visible"})},n=function(a){for(var b=0;b<a.targetTouches.length;b++){var c=a.targetTouches[b];e.hasData(c.identifier)&&(e.getData(c.identifier).$element.css({top:c.pageY+5,left:c.pageX+5,visibility:"visible"}),a.preventDefault())}},o=function(b){c.$apply(function(){for(var c=0;c<b.changedTouches.length;c++){var d=b.changedTouches[c];e.hasData(d.identifier)&&(a.$emit(l,d),e.removeData(d.identifier))}})};f.bind(g,m),f.bind(j,n),f.bind(d,h),f.bind(i,o),c.$on(b,function(){f.unbind(g,m),f.unbind(j,n),f.unbind(d,h),f.unbind(i,o)}),c.hasItems=function(){return c.items.length>0},c.items=e.datas}]),a.factory("dragAndDrop",function(){var a=function(){this.counter=0,this.datas={}};return a.prototype.setData=function(a,b,c,d,e,f){this.datas[a]={data:b,include:d,width:e,height:f,callback:c}},a.prototype.getData=function(a){return this.datas[a]},a.prototype.removeData=function(a){this.datas[a]&&delete this.datas[a]},a.prototype.hasData=function(a){return null!=this.datas[a]},new a}),a.directive("drag",["$rootScope","dragAndDrop","$controller",function(a,d){return{restrict:"A",link:function(a,e,f){var g=a.$eval(f.dragInclude),i=function(){if(f.dropCallback){var b=a.$eval(f.dropCallback);angular.isFunction(b)&&b(d.getData(id))}},j=function(b){b.preventDefault(),a.$apply(function(){f.dragModel&&d.setData(k,a.$eval(f.dragModel),i,g,e[0].offsetWidth,e[0].offsetHeight)})},l=function(b){b.preventDefault(),a.$apply(function(){for(var c=0;c<b.targetTouches.length;c++){var h=b.targetTouches[c];f.dragModel&&d.setData(h.identifier,a.$eval(f.dragModel),i,g,e[0].offsetWidth,e[0].offsetHeight)}})};e.bind(c,j),e.bind(h,l),a.$on(b,function(){e.unbind(c,j),e.unbind(h,l)})}}}]),a.directive("drop",["$rootScope","dragAndDrop","$document",function(a,c,h){return{restrict:"A",link:function(i,j,m){function n(a){if(m.dropCallback){var b=i.$eval(m.dropCallback);angular.isFunction(b)&&b(c.getData(a).data)}c.getData(a).callback(),c.removeData(a)}var o=function(a){c.hasData(k)&&(a.preventDefault(),i.$apply(function(){n(k)}))},p=function(a,b){var c=h[0].elementFromPoint(b.pageX,b.pageY);j[0].compareDocumentPosition(c)&Node.DOCUMENT_POSITION_CONTAINED_BY&&n(b.identifier)},q=function(a){return function(b){c.hasData(k)&&i.$apply(function(){var d=i.$eval(a);angular.isFunction(d)&&d(b,c.getData(k))})}};if(a.$on(l,p),j.bind(d,o),i.$on(b,function(){j.unbind(d,o)}),m.dropMouseEnter){var r=q(m.dropMouseEnter);j.bind(e,r),i.$on(b,function(){j.unbind(e,r)})}if(m.dropMouseLeave){var s=q(m.dropMouseLeave);j.bind(f,s),i.$on(b,function(){j.unbind(f,s)})}if(m.dropMouseMove){var t=q(m.dropMouseMove);j.bind(g,t),i.$on(b,function(){j.unbind(g,t)})}}}}])}(angular.module("dragAndDrop",[]));